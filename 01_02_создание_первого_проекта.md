# Создание первого проекта в Rust

## Введение

После успешной установки Rust и Cargo пришло время создать наш первый проект. В этом разделе мы рассмотрим, как использовать Cargo для создания нового проекта, познакомимся со структурой проекта Rust и напишем нашу первую программу.

## Использование Cargo для создания проекта

Cargo — это не только менеджер пакетов, но и система сборки для Rust, которая значительно упрощает создание и управление проектами. Для создания нового проекта используется команда `cargo new`.

### Создание нового проекта

Откройте терминал и выполните следующую команду:

```bash
cargo new hello_rust
```

Эта команда создаст новую директорию `hello_rust` с базовой структурой проекта Rust. По умолчанию Cargo создает исполняемый проект (бинарный файл). Если вы хотите создать библиотеку, добавьте флаг `--lib`:

```bash
cargo new hello_rust_lib --lib
```

### Параметры команды cargo new

Команда `cargo new` имеет несколько полезных параметров:

- `--bin` — создать исполняемый проект (используется по умолчанию)
- `--lib` — создать библиотеку
- `--vcs=git` — инициализировать Git-репозиторий (используется по умолчанию)
- `--vcs=none` — не инициализировать систему контроля версий
- `--edition=2021` — использовать определенную редакцию Rust (по умолчанию используется последняя стабильная)

Пример использования нескольких параметров:

```bash
cargo new hello_rust --vcs=none --edition=2021
```

## Структура проекта Rust

После создания проекта давайте рассмотрим его структуру. Перейдите в директорию проекта:

```bash
cd hello_rust
```

И посмотрите на созданные файлы:

```bash
ls -la
```

Вы увидите примерно следующее:

```
.
├── .git
├── .gitignore
├── Cargo.toml
└── src
    └── main.rs
```

Давайте рассмотрим каждый элемент:

### Файл Cargo.toml

Файл `Cargo.toml` — это основной файл конфигурации проекта Rust. Он написан в формате [TOML](https://toml.io/) (Tom's Obvious, Minimal Language) и содержит метаданные проекта и информацию о зависимостях.

Вот пример содержимого файла `Cargo.toml` для нового проекта:

```toml
[package]
name = "hello_rust"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
```

Файл содержит две основные секции:

#### Секция [package]

Эта секция содержит метаданные о вашем проекте:

- `name` — имя проекта
- `version` — версия проекта (следует [семантическому версионированию](https://semver.org/))
- `edition` — используемая редакция Rust (2015, 2018, 2021)

Вы можете добавить дополнительные метаданные, такие как:

```toml
[package]
name = "hello_rust"
version = "0.1.0"
edition = "2021"
authors = ["Ваше Имя <ваш.email@example.com>"]
description = "Простой проект для изучения Rust"
license = "MIT"
```

#### Секция [dependencies]

Эта секция используется для указания зависимостей вашего проекта. Изначально она пуста, но вы можете добавлять внешние библиотеки (крейты), которые хотите использовать:

```toml
[dependencies]
rand = "0.8.5"
serde = { version = "1.0", features = ["derive"] }
```

### Директория src

Директория `src` содержит исходный код вашего проекта. В новом исполняемом проекте Cargo создает файл `main.rs`, который является точкой входа в программу.

### Файл main.rs

Файл `src/main.rs` содержит функцию `main()`, которая является точкой входа для исполняемых программ на Rust. Cargo автоматически создает простую программу "Hello, world!":

```rust
fn main() {
    println!("Hello, world!");
}
```

Давайте разберем этот код:

- `fn main()` — объявление функции `main`, которая не принимает аргументов и ничего не возвращает
- `println!("Hello, world!");` — макрос для вывода текста в стандартный поток вывода

### Другие файлы

- `.git` — директория, содержащая информацию о Git-репозитории (если вы не отключили инициализацию Git)
- `.gitignore` — файл, указывающий Git, какие файлы и директории следует игнорировать

## Компиляция и запуск проекта

Теперь, когда мы создали проект, давайте скомпилируем и запустим его.

### Компиляция проекта

Для компиляции проекта используйте команду:

```bash
cargo build
```

Эта команда компилирует ваш проект и создает исполняемый файл в директории `target/debug/`. Если вы хотите создать оптимизированную версию для релиза, используйте:

```bash
cargo build --release
```

Оптимизированная версия будет создана в директории `target/release/` и будет работать быстрее, но компилироваться дольше.

### Запуск проекта

Для запуска проекта вы можете использовать:

```bash
cargo run
```

Эта команда компилирует проект (если необходимо) и запускает его. Вы увидите вывод:

```
Hello, world!
```

Если вы хотите запустить оптимизированную версию:

```bash
cargo run --release
```

### Проверка проекта без компиляции

Если вы хотите проверить, компилируется ли ваш код, но не хотите создавать исполняемый файл:

```bash
cargo check
```

Эта команда работает быстрее, чем `cargo build`, и полезна при разработке для быстрой проверки кода.

## Модификация программы "Hello, world!"

Давайте немного изменим нашу программу, чтобы она была более интерактивной. Откройте файл `src/main.rs` в любом текстовом редакторе и замените его содержимое следующим кодом:

```rust
use std::io;

fn main() {
    println!("Привет! Как тебя зовут?");
    
    let mut name = String::new();
    
    io::stdin()
        .read_line(&mut name)
        .expect("Не удалось прочитать строку");
    
    // Удаляем символ новой строки в конце
    let name = name.trim();
    
    println!("Приятно познакомиться, {}! Добро пожаловать в мир Rust!", name);
}
```

Давайте разберем этот код:

- `use std::io;` — импортирует модуль ввода-вывода из стандартной библиотеки
- `let mut name = String::new();` — создает изменяемую переменную `name` типа `String`
- `io::stdin().read_line(&mut name)` — читает строку из стандартного ввода и сохраняет ее в переменной `name`
- `.expect("Не удалось прочитать строку");` — обрабатывает возможную ошибку
- `let name = name.trim();` — удаляет пробельные символы (включая символ новой строки) в начале и конце строки
- `println!("Приятно познакомиться, {}! Добро пожаловать в мир Rust!", name);` — выводит приветствие, подставляя имя пользователя вместо `{}`

Сохраните файл и запустите программу:

```bash
cargo run
```

Теперь программа запросит ваше имя и выведет персонализированное приветствие.

## Создание проекта с зависимостями

Давайте создадим еще один проект, который будет использовать внешнюю библиотеку. Создайте новый проект:

```bash
cargo new random_number
cd random_number
```

Откройте файл `Cargo.toml` и добавьте зависимость от библиотеки `rand`:

```toml
[package]
name = "random_number"
version = "0.1.0"
edition = "2021"

[dependencies]
rand = "0.8.5"
```

Теперь откройте файл `src/main.rs` и замените его содержимое следующим кодом:

```rust
use rand::Rng;
use std::io;

fn main() {
    println!("Угадай число!");

    let secret_number = rand::thread_rng().gen_range(1..=100);

    println!("Загаданное число: {}", secret_number);
    println!("Пожалуйста, введите свою догадку.");

    let mut guess = String::new();

    io::stdin()
        .read_line(&mut guess)
        .expect("Не удалось прочитать строку");

    let guess: u32 = guess.trim().parse().expect("Пожалуйста, введите число!");

    println!("Вы загадали: {}", guess);

    if guess == secret_number {
        println!("Вы угадали!");
    } else if guess < secret_number {
        println!("Слишком маленькое!");
    } else {
        println!("Слишком большое!");
    }
}
```

Этот код:
1. Импортирует необходимые модули
2. Генерирует случайное число от 1 до 100
3. Запрашивает у пользователя догадку
4. Преобразует введенную строку в число
5. Сравнивает догадку с загаданным числом и выводит результат

Запустите программу:

```bash
cargo run
```

При первом запуске Cargo автоматически загрузит и скомпилирует библиотеку `rand` и все ее зависимости.

## Управление проектом с помощью Cargo

Cargo предоставляет множество команд для управления проектом:

- `cargo new` — создание нового проекта
- `cargo build` — компиляция проекта
- `cargo run` — компиляция и запуск проекта
- `cargo check` — проверка компиляции без создания исполняемого файла
- `cargo test` — запуск тестов
- `cargo doc` — генерация документации
- `cargo publish` — публикация библиотеки на crates.io
- `cargo clean` — удаление директории target
- `cargo update` — обновление зависимостей

## Заключение

В этом разделе мы научились создавать проекты Rust с помощью Cargo, познакомились со структурой проекта и написали несколько простых программ. Мы также узнали, как добавлять внешние зависимости и использовать их в своем коде.

Cargo значительно упрощает процесс разработки на Rust, автоматизируя многие рутинные задачи и обеспечивая единообразную структуру проектов. В следующих разделах мы будем использовать Cargo для всех наших проектов.

## Дополнительные ресурсы

- [Документация Cargo](https://doc.rust-lang.org/cargo/)
- [Книга "The Cargo Book"](https://doc.rust-lang.org/cargo/index.html)
- [crates.io](https://crates.io/) — репозиторий пакетов Rust